---
title: "Case Study B - Pain Relief Medication"
author: "Oumaima Al Qoh, Francisco Arrieta, Lucia Camenisch, Manuela Giansante, Emily Schmidt, Camille Beatrice Valera"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    toc: true # creating a table of contents (toc)
    toc_float: 
      collapsed: false # toc does not collapse and is shown as a sidebar (toc_float)
    number_sections: true # document sections are numbered
    theme: cosmo
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, fig.align = "center")
```

```{r packages}
library(data.table)
library(ggplot2)
```

```{r data}
pain <- fread("Bpain.csv")
```

```{r removing useless cols}
pain <- pain[, -c(1,6)]
```

```{r prop dummy}
pain <- pain[, Prop_dummy  := ifelse(Prop >= 0.5, "Efficient", "Inefficient")]
```



```{r}
ggplot(data = pain[Set %in% c("O", "B"),], aes(x = Marijuana, y = Prop)) + geom_line()
ggplot(data = pain[Set %in% c("O", "A"),], aes(x = Morphine, y = Prop)) + geom_line()
```


```{r}
pain_melt <- pain[Set %in% c("A", "B"),]
pain_melt <- pain_melt[, c(2,3,5)]
pain_melt <- melt(pain_melt, id.vars = "Prop")
pain_melt <- pain_melt[c(1:8, 22:26), ]
```


```{r}
ggplot(data = pain_melt, aes(x = value, y = Prop)) +
  geom_col(color = "black") +
  facet_wrap(~ variable) +
  scale_x_continuous(breaks = 1:16) +
  scale_y_continuous(breaks = seq(0,1,0.1)) +
  theme_light() +
  labs(title = "Proportion of mice responding per dosage of drug",
       x = "Dosage in mg/kg",
       y = "Proportion of mice responding")
```


```{r}
ggplot(data = pain_melt, aes(x = Prop, y = value)) +
  geom_point() +
  facet_wrap(~ variable, nrow = 2) +
  scale_x_continuous(breaks = seq(0, 1, 0.1)) +
  scale_y_continuous(breaks = seq(0,16,4)) +
  theme_light() +
  labs(title = "Dosages of Marijuana and Morphine vs Efficiency",
       x = "Efficiency",
       y = "Dosage in mg/kg")
  
```



```{r}
ggplot(pain[Set %in% "B",], aes(x = Marijuana, y = Morphine)) +
  geom_point(size = 2) +
  coord_equal() +
  theme_light() +
  scale_x_continuous(breaks = c(0:16)) +
  scale_y_continuous(breaks = c(0:8), limits = c(0,8)) +
  theme(axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank()) +
  labs(title = "Dosages of Marijuana",
       x = "Marijuana dosage in mg/kg")
```

```{r}
ggplot(pain[Set %in% "B",], aes(x = Marijuana, y = Morphine, color = Prop_dummy)) +
  geom_point(size = 2) +
  coord_equal() +
  theme_light() +
  scale_x_continuous(breaks = c(0:16)) +
  scale_y_continuous(breaks = c(0:8), limits = c(0,8)) +
  theme(axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank()) +
  labs(title = "Dosages of Marijuana",
       x = "Marijuana dosage in mg/kg",
       color = "Efficency \nof dosages")
```

```{r}
ggplot(pain[Set %in% "B",], aes(x = Marijuana, y = Morphine, color = Prop_dummy)) +
  geom_point(size = 2) +
  geom_point(data = pain[Set %in% "A",], mapping = aes(x = Marijuana, y = Morphine), size = 2, color = "black") +
  coord_equal() +
  theme_light() +
  scale_x_continuous(breaks = c(0:16)) +
  scale_y_continuous(breaks = c(0:8), limits = c(0,8)) +
  labs(title = "Dosages of Marijuana and Morphine",
       x = "Marijuana dosage in mg/kg",
       y = "Morphine dosage in mg/kg",
       color = "Efficency \nof dosages")
```



```{r}
ggplot(pain[Set %in% c("A", "B"),], aes(x = Marijuana, y = Morphine, color = Prop_dummy)) +
  geom_point(size = 2) +
  coord_equal() +
  theme_light() +
  scale_x_continuous(breaks = c(0:16)) +
  scale_y_continuous(breaks = c(0:8), limits = c(0,8)) +
  labs(title = "Dosages of Marijuana and Morphine",
       x = "Marijuana dosage in mg/kg",
       y = "Morphine dosage in mg/kg",
       color = "Efficency \nof dosages")
```

```{r}
ggplot(pain[Set %in% c("O", "A", "B"),], aes(x = Marijuana, y = Morphine, color = Prop_dummy)) +
  geom_point(size = 2) +
  coord_equal() +
  theme_light() +
  scale_x_continuous(breaks = c(0:16)) +
  scale_y_continuous(breaks = c(0:8), limits = c(0,8)) +
  labs(title = "Dosages of Marijuana and Morphine",
       x = "Marijuana dosage in mg/kg",
       y = "Morphine dosage in mg/kg",
       color = "Efficency \nof dosages")
```

```{r}
ggplot(pain[Set %in% c("O", "A", "B"),], aes(x = Marijuana, y = Morphine, color = Prop_dummy)) +
  geom_point(size = 2) +
  geom_point(data = pain[Set %in% "AB",], mapping = aes(x = Marijuana, y = Morphine), size = 2, color = "black") +
  coord_equal() +
  theme_light() +
  scale_x_continuous(breaks = c(0:16)) +
  scale_y_continuous(breaks = c(0:8), limits = c(0,8)) +
  labs(title = "Dosages of Marijuana and Morphine",
       x = "Marijuana dosage in mg/kg",
       y = "Morphine dosage in mg/kg",
       color = "Efficency \nof dosages")
```

```{r}
ggplot(pain, aes(x = Marijuana, y = Morphine, color = Prop_dummy)) +
  geom_point(size = 2) +
  coord_equal() +
  theme_light() +
  scale_x_continuous(breaks = c(0:16)) +
  scale_y_continuous(breaks = c(0:8)) +
  labs(title = "Dosages of Marijuana and Morphine",
       x = "Marijuana dosage in mg/kg",
       y = "Morphine dosage in mg/kg",
       color = "Efficency \nof dosages")
```


```{r}
ggplot(pain, aes(x = Marijuana, y = Morphine, color = Prop_dummy)) +
  geom_point(size = 2) +
  coord_equal() +
  geom_abline(intercept = 5, slope = -5/4) +
  theme_light() +
  scale_x_continuous(breaks = c(0:16)) +
  scale_y_continuous(breaks = c(0:8)) +
  labs(title = "Dosages of Marijuana and Morphine with Isobole",
       x = "Marijuana dosage in mg/kg",
       y = "Morphine dosage in mg/kg",
       color = "Efficency \nof dosages")
```

```{r}
ggplot(pain, aes(x = Marijuana, y = Morphine, color = Prop_dummy)) +
  geom_point(size = 2) +
  coord_equal() +
  geom_point(mapping = aes(x = 2.1, y = 0), color = "black", fill = "red", size = 3, pch = 22) +
  geom_abline(intercept = 5, slope = -5/2.1) +
  theme_light() +
  scale_x_continuous(breaks = c(0:16)) +
  scale_y_continuous(breaks = c(0:8)) +
  labs(title = "Dosages of Marijuana and Morphine with Isobole",
       x = "Marijuana dosage in mg/kg",
       y = "Morphine dosage in mg/kg",
       color = "Efficency \nof dosages")
```



